<!DOCTYPE HTML>
<html lang="fr">
	<head>
		<title>Rasende Roboter</title>
		<script src="http://codeorigin.jquery.com/jquery-2.0.3.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script src="js/commonModule.js"></script>
		<script src="js/robot.js"></script>
		<script src="js/logged.js"></script>
		
		<link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" media="all" />
		<link rel="stylesheet" href="css/sticky-footer.css" type="text/css" media="all" />
		<link rel="stylesheet" type="text/css" href="css/main.css">
	</head>
	<body ng-app="loggedApp" ng-controller="mainController" ng-init="idGame = __IDGAME__" ng-keydown="keyPress($event)">
		<header id="header" class="container">
			<div class="navbar navbar-default">
			  <div class="container">
				<div class="navbar-header">
				  <a href="/" ><h1 class="navbar-brand">Rasende Roboter <small>Le jeu de robots en ligne</small></h1></a>
				</div>
			  </div>
			</div>
        </header>
        
        <div class="container">
			<input id="login" type="hidden" value="__LOGIN__"/>
			<input id="idGame" type="hidden" value="__IDGAME__"/>
			<section>
				<div class="col-sm-12 col-md-3">
					<div class="well">
						<legend>Les participants</legend>
						<ul ng-controller="participantsController">
							<li ng-repeat="p in participants">{{p}}</li>
						</ul>
					</div>
				</div>
				<div ng-controller="mapController">
					<div class="col-sm-12 col-md-5">
						<div class="well">
							<legend>Partie: {{gameName}}</legend>
							<div class="alert alert-info" ng-show="countDown && !victory">
								<p>{{firstFinder}} a trouvé une solution.<br>
								Il vous reste <strong>{{countDown}} secondes !</strong></p>
							</div>
							<div class="alert alert-danger" ng-show="tooLate">
								<strong>Trop tard, cette partie est déjà finie.</strong>
							</div>
							<div class="alert alert-danger" ng-show="error">
								<strong>HACKER !!!</strong> Ou peut-être c'est un bug.
							</div>
							<div class="alert alert-success" ng-show="victory">
								<strong>Victory</strong>
								<p ng-show="firstFinder == player">Vous avez été le premier à trouver!</p>
							</div>
							<div id="tableWrap">
								<div class="map-overlay" ng-show="$parent.terminateGame"></div>
								<table>
									<tr ng-repeat="row in game.map">
										<td ng-repeat="cell in row" class="cell"
											ng-class="{'cell-border-left': cell.g == 1, 'cell-border-right': cell.d == 1, 'cell-border-top': cell.h == 1, 'cell-border-bottom': cell.b == 1,
											'target-red': cell.target == 'red', 'target-blue': cell.target == 'blue', 'target-yellow': cell.target == 'yellow', 'target-green': cell.target == 'green'}">
											<div class="robot" ng-show="cell.robot" ng-click="selectRobot(cell.robot)"
												ng-class="{'robot-blue': cell.robot.color == 'blue', 'robot-red': cell.robot.color == 'red', 'robot-yellow': cell.robot.color == 'yellow',
													'robot-green': cell.robot.color == 'green', 'robot-selected': cell.robot.selected, 'robot-unselectable': !cell.robot.canMove(game.lastRobotMoved)}"></div>
										</td>
									</tr>
								</table>
							</div>
						</div>
					</div>
					<div class="col-sm-12 col-md-3">
						<div class="well">
							<legend>Actions</legend>
							<p>Utilisez les fléches du clavier et espace pour changer de robot, ou les boutons en-dessous pour faire déplacer les robots.</p>
							<button type="button" class="btn" ng-click="move('UP')"
								ng-disabled="$parent.terminateGame || (game.selectedRobot && !game.selectedRobot.canMoveUp())">Up</button>
							<button type="button" class="btn" ng-click="move('DOWN')"
								ng-disabled="$parent.terminateGame || (game.selectedRobot && !game.selectedRobot.canMoveDown())">Down</button>
							<button type="button" class="btn" ng-click="move('RIGHT')"
								ng-disabled="$parent.terminateGame || (game.selectedRobot && !game.selectedRobot.canMoveRight())">Right</button>
							<button type="button" class="btn" ng-click="move('LEFT')"
								ng-disabled="$parent.terminateGame || (game.selectedRobot && !game.selectedRobot.canMoveLeft())">Left</button>
							<div><button type="button" class="btn btn-warning" ng-click="reset()"
								ng-disabled="$parent.terminateGame">reset</button></div>
						</div>
					</div>
				</div>
			</section>
		</div>
		<footer id="footer" class="container">
		  <p class="credit">
			M2PGI project. <a href="https://github.com/Luze26/RasendeRoboter">See the project on GitHub</a>.
		  </p>
		</footer>
	</body>
</html>

