<!DOCTYPE HTML>
<html lang="fr">
	<head>
		<title>Rasende Roboter</title>

		<link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" media="all" />
		<link rel="stylesheet" href="css/sticky-footer.css" type="text/css" media="all" />
		<link rel="stylesheet" type="text/css" href="css/main.css">
	</head>
	<body ng-app="loggedApp" ng-controller="mainController" ng-init="idGame = __IDGAME__" ng-keydown="keyPress($event)">
		<header id="header" class="container">
			<div class="navbar navbar-default">
			  <div class="container">
				<div class="navbar-header">
				  <a href="/" ><h1 class="navbar-brand">Rasende Roboter <small>Le jeu de robots en ligne</small></h1></a>
				</div>
			  </div>
			</div>
        </header>
        
        <div class="container">
			<input id="login" type="hidden" value="__LOGIN__"/>
			<input id="idGame" type="hidden" value="__IDGAME__"/>
			<section>
				<div class="col-sm-12 col-md-3">
					<div class="well">
						<legend>Les participants</legend>
						<ul>
							<li ng-repeat="p in participants | orderBy:'place'" ng-class="{'me': p.me}">
								{{p.place}}  {{p.name}} <span ng-show="p.name == firstFinder">*</span>
							</li>
						</ul>
					</div>
				</div>
				<div ng-controller="mapController">
					<div class="col-sm-12 col-md-5">
						<div class="well">
							<legend>Partie: {{gameName}}</legend>
							<div class="alert alert-info" ng-show="!$parent.terminateGame && countDown && !victory" ng-cloak>
								<p><strong>{{firstFinder}}</strong> a été le premier à trouvé une solution.<br>
								Il vous reste <strong>{{countDown}} secondes !</strong></p>
							</div>
							<div class="alert alert-danger" ng-show="tooLate" ng-cloak>
								<strong>Trop tard, cette partie est déjà finie.</strong>
							</div>
							<div class="alert alert-danger" ng-show="error" ng-cloak>
								<strong>HACKER !!!</strong> Ou peut-être c'est un bug.
							</div>
							<div class="alert" ng-class="$parent.finders[login] == 1 ? 'alert-success' : 'alert-info'"
								ng-show="$parent.terminateGame" ng-cloak>
								<div ng-switch="$parent.finders[login]">
									<p ng-switch-when="1">Yeah man! T'as fini premier.</p>
									<div ng-switch-default>
										<p ng-show="$parent.isWinner">
											<strong>{{$parent.winner}}</strong> a fini premier.
										</p>
										<p ng-show="victory">
											T'as fini {{$parent.finders[login]}}ème.
										</p>
									</div>
								</div>
							</div>
							<div class="alert alert-success" ng-show="!$parent.terminateGame && victory">
								<p>
									T'as <span ng-show="firstFinder == player">été le premier à avoir</span> trouvé une solution!<br>
									T'es actuellement classé: <strong>{{$parent.finders[login]}}</strong>.<br>
									<span ng-show="countDown">Il reste {{countDown}} secondes aux participants pour proposer leur solution.</span>
								</p>
							</div>
							<div id="tableWrap">
								<div class="map-overlay" ng-show="$parent.terminateGame || victory"></div>
								<table>
									<tr ng-repeat="row in game.map">
										<td ng-repeat="cell in row" class="cell"
											ng-class="{'cell-border-left': cell.g == 1, 'cell-border-right': cell.d == 1, 'cell-border-top': cell.h == 1, 'cell-border-bottom': cell.b == 1,
											'target-red': cell.target == 'red', 'target-blue': cell.target == 'blue', 'target-yellow': cell.target == 'yellow', 'target-green': cell.target == 'green'}">
											<div class="robot" ng-show="cell.robot" ng-click="selectRobot(cell.robot)"
												ng-class="{'robot-blue': cell.robot.color == 'blue', 'robot-red': cell.robot.color == 'red', 'robot-yellow': cell.robot.color == 'yellow',
													'robot-green': cell.robot.color == 'green', 'robot-selected': cell.robot.selected, 'robot-unselectable': !cell.robot.canMove(game.lastRobotMoved)}"></div>
										</td>
									</tr>
								</table>
							</div>
						</div>
					</div>
					<div class="col-sm-12 col-md-3">
						<div class="well">
							<legend>Actions</legend>
							<button type="button" class="btn" ng-click="move('UP')" title="Bouge le robot en haut"
								ng-disabled="$parent.terminateGame || victory || (game.selectedRobot && !game.selectedRobot.canMoveUp())">Haut</button>
							<button type="button" class="btn" ng-click="move('DOWN')" title="Bouge le robot en bas"
								ng-disabled="$parent.terminateGame || victory || (game.selectedRobot && !game.selectedRobot.canMoveDown())">Bas</button>
							<button type="button" class="btn" ng-click="move('RIGHT')" title="Bouge le robot à droite"
								ng-disabled="$parent.terminateGame || victory || (game.selectedRobot && !game.selectedRobot.canMoveRight())">Droite</button>
							<button type="button" class="btn" ng-click="move('LEFT')" title="Bouge le robot à gauche"
								ng-disabled="$parent.terminateGame || victory || (game.selectedRobot && !game.selectedRobot.canMoveLeft())">Gauche</button>
							<div><button type="button" class="btn btn-warning" ng-click="reset()" title="Remet à 0 le plateau"
								ng-disabled="$parent.terminateGame || victory">RAZ</button></div>
							<p>Fléches du clavier pour déplacer les robots.<br>Espace pour changer de robot.</p>
						</div>
					</div>
				</div>
			</section>
		</div>
		<footer id="footer" class="container">
		  <p class="credit">
			M2PGI project. <a href="https://github.com/Luze26/RasendeRoboter">See the project on GitHub</a>.
		  </p>
		</footer>
		
		<script src="http://codeorigin.jquery.com/jquery-2.0.3.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<!-- PROD JS <script src="js/min/main.min.js"></script>-->
		<script src="js/commonModule.js"></script>
		<script src="js/robot.js"></script>
		<script src="js/logged.js"></script>
	</body>
</html>

